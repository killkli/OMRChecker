# OMR Checker 使用者指南

## 目錄
1. [系統簡介](#系統簡介)
2. [快速開始](#快速開始)
3. [功能說明](#功能說明)
4. [進階使用](#進階使用)
5. [常見問題](#常見問題)
6. [瀏覽器相容性](#瀏覽器相容性)
7. [故障排除](#故障排除)

---

## 系統簡介

**OMR Checker** 是一個完全在瀏覽器端運行的光學標記辨識 (Optical Mark Recognition) 系統，可以：

- ✅ 自動辨識答案卡上的填塗答案
- ✅ 即時評分並顯示詳細結果
- ✅ 匯出 CSV 或 JSON 格式的結果
- ✅ 本地儲存處理歷史記錄
- ✅ 完全離線運作，保護隱私

### 技術特點

- **無需伺服器**: 所有處理都在您的瀏覽器中完成
- **保護隱私**: 影像不會上傳到任何伺服器
- **高效能**: 使用 WebAssembly 技術加速影像處理
- **開源**: 基於 OpenCV.js 和 OMRChecker 專案

---

## 快速開始

### 步驟 1: 開啟應用程式

1. 使用支援的瀏覽器（Chrome、Edge、Firefox）開啟 `index.html`
2. 等待系統初始化（首次載入需要 5-10 秒）
3. 看到「系統就緒」訊息後即可開始使用

### 步驟 2: 上傳答案卡影像

有兩種方式上傳影像：

**方法 1: 拖放上傳**
- 直接將影像檔案拖放到虛線框內

**方法 2: 選擇檔案**
- 點擊「選擇檔案」按鈕
- 瀏覽並選擇答案卡影像

**支援格式**: JPG、PNG
**檔案大小限制**: 最大 10MB
**建議解析度**: 1500x2000 像素以上

### 步驟 3: 查看處理結果

上傳後，系統會自動：

1. ✅ 驗證檔案格式
2. ✅ 執行影像預處理（灰階、降噪、二值化）
3. ✅ 偵測答案卡四個角點
4. ✅ 執行透視校正
5. ✅ 辨識填塗答案
6. ✅ 自動評分並顯示結果

處理完成後，您會看到：

- **原始影像**: 上傳的原始答案卡
- **處理步驟**: 灰階、降噪、二值化等中間結果
- **角點檢測**: 標示出四個角點的位置
- **透視校正**: 修正後的正面影像
- **答案檢測結果**: 標示正確（綠色）、錯誤（紅色）、未填塗（灰色）

---

## 功能說明

### 1. 儲存結果

點擊「💾 儲存結果」按鈕，將當前處理結果儲存到瀏覽器本地資料庫。

**儲存內容包含**:
- 原始影像
- 處理後影像
- 答案資料
- 評分結果
- 時間戳記

### 2. 匯出 CSV

點擊「📊 匯出 CSV」按鈕，將當前結果匯出為 CSV 格式。

**CSV 格式範例**:
```csv
題號,學生答案,正確答案,是否正確
1,A,A,✓
2,B,C,✗
3,C,C,✓
...
總分,85,100,85%
```

**適用情境**: 需要在 Excel 或 Google Sheets 中進一步分析

### 3. 匯出 JSON

點擊「📄 匯出 JSON」按鈕，將當前結果匯出為 JSON 格式。

**JSON 格式範例**:
```json
{
  "timestamp": "2025-10-05T14:00:00Z",
  "templateName": "標準測驗模板",
  "answers": {
    "1": ["A"],
    "2": ["B"]
  },
  "scoring": {
    "score": 85,
    "totalPoints": 100,
    "percentage": 85
  }
}
```

**適用情境**: 需要與其他系統整合或程式化處理

### 4. 查看處理歷史

1. 點擊頁面底部的「📋 查看歷史記錄」
2. 瀏覽所有已儲存的處理記錄
3. 可以：
   - 查看縮圖和基本資訊
   - 刪除單筆記錄
   - 批次匯出所有記錄（CSV 或 JSON）
   - 清空所有記錄

### 5. 重新處理

點擊「🔄 重新處理」按鈕，使用相同的影像重新執行辨識流程。

**適用情境**:
- 懷疑辨識結果不正確
- 測試不同的處理參數

### 6. 上傳新圖片

點擊「📤 上傳新圖片」按鈕，清除當前結果並回到上傳頁面。

---

## 進階使用

### 自訂模板

如果需要使用自訂的答案卡模板：

1. 參考 `templates/default-template.json` 的格式
2. 建立新的模板 JSON 檔案
3. 修改 `app.js` 中的模板載入路徑

**模板格式說明**:
```json
{
  "name": "我的模板",
  "totalQuestions": 50,
  "questionsPerRow": 5,
  "bubbleRadius": 10,
  "bubbleSpacing": 50,
  "correctAnswers": {
    "1": "A",
    "2": "B"
  }
}
```

### 批次處理

目前版本暫不支援批次上傳多張影像，但您可以：

1. 逐一處理每張答案卡
2. 每次處理後點擊「儲存結果」
3. 完成後使用「查看歷史記錄」→「匯出 CSV/JSON」進行批次匯出

### 整合其他系統

透過 JSON 匯出功能，您可以：

1. 將結果匯入到學習管理系統 (LMS)
2. 使用 Python/R 進行統計分析
3. 建立自動化評分工作流程

**Python 範例**:
```python
import json

with open('omr-result.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

print(f"總分: {data['scoring']['score']}")
print(f"答對率: {data['scoring']['percentage']}%")
```

---

## 常見問題

### Q1: 為什麼首次載入需要這麼久？

**A**: 系統需要下載 OpenCV.js 函式庫（約 8MB），這是一個完整的電腦視覺函式庫。首次下載後會被瀏覽器快取，之後的載入會快很多。

### Q2: 辨識結果不準確怎麼辦？

**A**: 請確保：
- ✅ 影像解析度足夠（建議 1500x2000 以上）
- ✅ 答案卡四個角點清晰可見
- ✅ 填塗飽滿且均勻
- ✅ 沒有過度的光線反射或陰影
- ✅ 答案卡沒有摺痕或汙損

### Q3: 支援哪些答案卡格式？

**A**: 目前使用預設模板，支援標準的 OMR 答案卡格式。如需支援其他格式，需要自訂模板。

### Q4: 儲存的資料會佔用多少空間？

**A**: 每筆記錄約 1-3MB（取決於影像大小）。建議定期清理不需要的歷史記錄。可在「查看歷史記錄」中查看目前使用量。

### Q5: 資料會被上傳到雲端嗎？

**A**: 不會。所有處理和儲存都在您的瀏覽器本地完成，絕對不會上傳到任何伺服器。

### Q6: 可以在手機上使用嗎？

**A**: 可以，但建議使用桌面版瀏覽器以獲得最佳體驗。行動裝置的運算能力較低，處理速度會比較慢。

### Q7: 如何備份處理結果？

**A**: 使用「查看歷史記錄」→「匯出 JSON」功能，將所有記錄匯出為 JSON 檔案進行備份。

### Q8: 清除瀏覽器資料會遺失記錄嗎？

**A**: 是的。如果清除瀏覽器的 IndexedDB 資料，所有儲存的記錄都會遺失。請定期匯出備份。

---

## 瀏覽器相容性

### 完全支援 ✅

- Google Chrome 90+
- Microsoft Edge 90+
- Firefox 88+
- Safari 14+ (macOS/iOS)

### 必要功能需求

- ✅ Web Workers
- ✅ WebAssembly
- ✅ IndexedDB
- ✅ Canvas API
- ✅ File API
- ✅ Blob API

### 效能建議

- **最佳**: Chrome/Edge（最佳 WebAssembly 效能）
- **良好**: Firefox
- **可用**: Safari（效能稍慢）

---

## 故障排除

### 問題：頁面一直顯示「系統初始化中」

**解決方法**:
1. 檢查網路連線（首次需要下載 OpenCV.js）
2. 清除瀏覽器快取後重新載入
3. 使用 F12 開啟開發者工具查看 Console 錯誤訊息
4. 確認瀏覽器版本是否符合需求

### 問題：上傳影像後沒有反應

**解決方法**:
1. 確認檔案格式為 JPG 或 PNG
2. 確認檔案大小不超過 10MB
3. 檢查影像是否損壞（嘗試用其他軟體開啟）
4. 查看 Console 是否有錯誤訊息

### 問題：辨識結果全部是「未填塗」

**解決方法**:
1. 檢查影像是否清晰
2. 確認答案卡格式與模板相符
3. 嘗試提高影像解析度
4. 確認填塗是否足夠深

### 問題：無法儲存或查看歷史記錄

**解決方法**:
1. 確認瀏覽器支援 IndexedDB
2. 檢查瀏覽器是否啟用了「阻止所有 Cookie」
3. 確認儲存空間未滿
4. 嘗試在無痕模式下測試（但資料不會持久化）

### 問題：匯出的 CSV 在 Excel 中亂碼

**解決方法**:
1. 使用 Excel 的「資料」→「從文字/CSV」功能匯入
2. 選擇編碼為「UTF-8」
3. 或使用 Google Sheets（預設支援 UTF-8）

### 仍有問題？

1. 查看專案的 GitHub Issues
2. 提交新的 Issue 並附上：
   - 瀏覽器版本
   - 錯誤訊息截圖
   - Console 錯誤日誌
   - 問題重現步驟

---

## 效能最佳化建議

### 影像準備

1. **解析度**: 1500-2000px 寬度即可，過高會增加處理時間
2. **檔案大小**: 壓縮至 1-2MB（JPG 品質 85-90）
3. **拍攝技巧**:
   - 使用良好光線
   - 正面拍攝（減少透視校正的負擔）
   - 避免陰影和反光

### 系統設定

1. 關閉不必要的瀏覽器擴充功能
2. 確保有足夠的可用記憶體
3. 使用桌面版瀏覽器而非行動版

---

## 隱私與安全

### 資料處理原則

- ✅ **完全本地處理**: 影像和結果不會離開您的裝置
- ✅ **無追蹤**: 不使用 Google Analytics 或任何追蹤工具
- ✅ **開源透明**: 所有原始碼公開可審查

### 資料儲存

- 資料儲存在瀏覽器的 IndexedDB 中
- 只有您可以存取
- 清除瀏覽器資料會一併刪除

### 建議

- 處理敏感資料後，記得清除歷史記錄
- 定期匯出重要結果並備份
- 不建議在公用電腦上使用

---

## 更新日誌

### v1.0.0 (2025-10-05)

- ✅ 完整的 OMR 辨識功能
- ✅ CSV/JSON 匯出
- ✅ 本地資料儲存
- ✅ 處理歷史管理
- ✅ 響應式設計
- ✅ 完整的使用者指南

---

## 授權與致謝

本專案基於以下開源專案：

- [OpenCV.js](https://docs.opencv.org/4.x/d5/d10/tutorial_js_root.html) - Apache License 2.0
- [OMRChecker](https://github.com/Udayraj123/OMRChecker) - GPLv3

感謝所有開源貢獻者！

---

## 聯絡方式

- 專案網站: [GitHub Repository]
- 問題回報: [GitHub Issues]
- 技術支援: 請參考專案文件

---

**最後更新**: 2025-10-05
**版本**: 1.0.0
